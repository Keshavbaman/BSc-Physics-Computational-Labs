import numpy as np
import matplotlib.pyplot as plt

def bisection(func, a, b, tol=1e-6, max_iter=100):
    """
    Implements Bisection Method to find root of f(x) in [a, b].
    Based on Q1 & Q2 of Practical File.
    """
    if func(a) * func(b) >= 0:
        print("Bisection method fails. f(a) and f(b) must have opposite signs.")
        return None

    print(f"{'Iter':<5} {'a':<12} {'b':<12} {'c (mid)':<12} {'f(c)':<12}")
    
    for k in range(1, max_iter + 1):
        c = (a + b) / 2
        fc = func(c)
        
        print(f"{k:<5} {a:<12.6f} {b:<12.6f} {c:<12.6f} {fc:<12.6f}")
        
        if abs(fc) < tol or (b - a) / 2 < tol:
            print(f"Converged to root: {c:.6f} after {k} iterations.")
            return c
        
        if func(a) * fc < 0:
            b = c
        else:
            a = c
            
    print("Max iterations reached.")
    return c

# --- Q1: Solve cos(x) - x = 0 ---
print("\n--- Question 1: f(x) = cos(x) - x ---")
f1 = lambda x: np.cos(x) - x
root1 = bisection(f1, 0, 1, max_iter=5)

# Plotting Q1
x = np.linspace(0, 3, 100)
plt.plot(x, f1(x), label='cos(x) - x')
plt.axhline(0, color='k', linestyle='--')
plt.title('Bisection Method: f(x) = cos(x) - x')
plt.legend()
plt.grid()
plt.show()

# --- Q2: Solve x^3 - 2 = 0 ---
print("\n--- Question 2: f(x) = x^3 - 2 ---")
f2 = lambda x: x**3 - 2
root2 = bisection(f2, 1, 2, tol=1e-4)
